# SurrealDB Sink Connector - Multi-Topic Configuration Example
#
# This example shows how to consume from multiple Danube topics with different
# schema types and route each to different SurrealDB tables.

connector_name = "surrealdb-sink-multi"
danube_service_url = "http://localhost:6650"

[surrealdb]
url = "ws://localhost:8000"
namespace = "production"
database = "analytics"

# Optional authentication
username = "admin"
password = "secure_password"

connection_timeout_secs = 30
request_timeout_secs = 30

# Global defaults
batch_size = 100
flush_interval_ms = 1000

#######################
# User Events Topic (JSON Schema)
#######################
[[surrealdb.topic_mappings]]
topic = "/events/user"
subscription = "surrealdb-user-events"
table_name = "user_events"
schema_type = "Json"

include_danube_metadata = true
batch_size = 200  # Higher batch for high-volume topic
flush_interval_ms = 500  # Faster flush for real-time analytics

#######################
# IoT Sensor Data Topic (JSON Schema)
#######################
[[surrealdb.topic_mappings]]
topic = "/iot/sensors"
subscription = "surrealdb-iot-data"
table_name = "sensor_readings"
schema_type = "Json"

# Auto-generate IDs for time-series data
include_danube_metadata = true
batch_size = 500  # Larger batch for IoT streams
flush_interval_ms = 2000  # Less frequent flush to reduce write load

#######################
# System Logs Topic (String Schema)
#######################
[[surrealdb.topic_mappings]]
topic = "/system/logs"
subscription = "surrealdb-logs"
table_name = "system_logs"
schema_type = "String"

include_danube_metadata = true
batch_size = 50  # Small batch for critical logs
flush_interval_ms = 100  # Fast flush for real-time monitoring

#######################
# Metrics Topic (Int64 Schema)
#######################
[[surrealdb.topic_mappings]]
topic = "/metrics/counters"
subscription = "surrealdb-metrics"
table_name = "metric_counters"
schema_type = "Int64"

include_danube_metadata = true
batch_size = 100
flush_interval_ms = 1000

#######################
# Binary Data Topic (Bytes Schema)
#######################
[[surrealdb.topic_mappings]]
topic = "/data/binary"
subscription = "surrealdb-binary"
table_name = "binary_data"
schema_type = "Bytes"

include_danube_metadata = false  # Keep records clean
batch_size = 50
flush_interval_ms = 2000

#######################
# E-commerce Orders Topic (JSON Schema)
#######################
[[surrealdb.topic_mappings]]
topic = "/orders/created"
subscription = "surrealdb-orders"
table_name = "orders"
schema_type = "Json"

include_danube_metadata = false  # Clean records for API responses
batch_size = 20  # Small batch for transactional consistency
flush_interval_ms = 100  # Fast flush for order processing
